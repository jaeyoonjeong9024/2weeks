import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler  # ğŸ‘ˆ í”¼ì²˜ ìŠ¤ì¼€ì¼ë§ì„ ìœ„í•´ ì¶”ê°€
from sklearn.tree import DecisionTreeClassifier
from sklearn.ensemble import RandomForestClassifier
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import accuracy_score

# -----------------------------
# 1) ë°ì´í„° ì¤€ë¹„
# -----------------------------

# íŒŒì¼ì— í—¤ë”ê°€ ìˆìœ¼ë¯€ë¡œ header=None, names=cols ì‚­ì œ
# ì²« ë²ˆì§¸ ì»¬ëŸ¼ì€ ë¶ˆí•„ìš”í•œ ì¸ë±ìŠ¤ì´ë¯€ë¡œ index_col=0ìœ¼ë¡œ ì§€ì •í•˜ì—¬ ë°”ë¡œ ì œê±°
df = pd.read_csv("/content/drive/MyDrive/breast_cancer.csv", index_col=0)

# X: 'label' ì»¬ëŸ¼ì„ ì œì™¸í•œ ëª¨ë“  ë°ì´í„° (ë¬¸ì œì§€)
X = df.drop(columns=["label"])
# y: 'label' ì»¬ëŸ¼ ë°ì´í„° (ì •ë‹µì§€)
y = df["label"]

# --- í”¼ì²˜ ìŠ¤ì¼€ì¼ë§ (StandardScaler) ---
# ê° í”¼ì²˜(ì»¬ëŸ¼)ë“¤ì˜ ê°’ì˜ ë²”ìœ„ë¥¼ ë¹„ìŠ·í•˜ê²Œ ë§ì¶°ì£¼ëŠ” ì‘ì—…
# ëª¨ë¸ì˜ ì„±ëŠ¥ê³¼ ì•ˆì •ì„±ì„ ë†’ì—¬ì¤ë‹ˆë‹¤.
scaler = StandardScaler()
X_scaled = scaler.fit_transform(X)

# ìŠ¤ì¼€ì¼ë§ëœ ë°ì´í„°ë¥¼ í•™ìŠµìš©ê³¼ í…ŒìŠ¤íŠ¸ìš©ìœ¼ë¡œ ë¶„ë¦¬
X_train, X_test, y_train, y_test = train_test_split(
    X_scaled, y, test_size=0.2, stratify=y, random_state=42
)

# -----------------------------
# 2) ëª¨ë¸ êµ¬ì„±
# -----------------------------
dt = DecisionTreeClassifier(random_state=42)
rf = RandomForestClassifier(n_estimators=200, random_state=42)
lr = LogisticRegression(max_iter=500)

# -----------------------------
# 3) ëª¨ë¸ í•™ìŠµ
# -----------------------------
# ìŠ¤ì¼€ì¼ë§ëœ í•™ìŠµ ë°ì´í„°ë¡œ ëª¨ë¸ë“¤ì„ í•™ìŠµì‹œí‚µë‹ˆë‹¤.
dt.fit(X_train, y_train)
rf.fit(X_train, y_train)
lr.fit(X_train, y_train)

# -----------------------------
# 4) ëª¨ë¸ í‰ê°€
# -----------------------------
dt_acc = accuracy_score(y_test, dt.predict(X_test))
rf_acc = accuracy_score(y_test, rf.predict(X_test))
lr_acc = accuracy_score(y_test, lr.predict(X_test))

print("=== Test Accuracy ===")
print(f"Decision Tree : {dt_acc:.4f}")
print(f"Random Forest : {rf_acc:.4f}")
print(f"Logistic Reg. : {lr_acc:.4f}")
